<div ui-view="header"></div>

<div ui-view="content"></div>

<div ui-view="footer"></div>
<!-- <!DOCTYPE html>
<html>
  <body>

    <script type="text/javascript" src="content/js/jquery-3.1.0.min.js"></script>
    <script type="text/javascript" src="content/js/materialize.min.js"></script>
    <script type="text/javascript" src="content/js/mustache.min.js"></script>
    <script type="text/javascript" src="content/js/enquadrados.js"></script>
    <script type="application/javascript">
      $(document).ready(function() {
        $('select').material_select();
        $.ajax({
          type:'GET',
          url: 'http://localhost:8000/cidades/ranking/funcionario/area?format=json',
          data: {},
          success: function(data, status) {
            var top_five = [];
            var index = 0;
            for (entry in data["folhas"]) {
              if (index >= 5) {
                break;
              }
              var city_id = data["folhas"][entry]["cidade"]["id"];
              var city_name = data["folhas"][entry]["cidade"]["nome"];
              var area = parseFloat(data["folhas"][entry]["area"]);
              var workers_total = count_workers(data["folhas"][entry]["funcionarios"]);;
              top_five.push({ 'city_id': city_id, 'city_name': city_name, 'ratio': (area / workers_total).toFixed(2), 'position': ++index  });
            }
            var renderedList = Mustache.render("<li><h5 class='valign white-text' style='min-height:100px;'>Menos m² por funcionário<br/><small class='valign white-text'>(m² / funcionário)</small><div class='valign white-text' style='font-size:10pt;'>Quanto cada funcionário teria de espaço para trabalhar?</div></h5></li>{{#results}}<li class='hide-on-med-only'><h5 class='valign'><a class='white-text hoverable' style='padding-left:20px; padding-right:20px;' href='/city.html?city_id={{city_id}}'>{{position}}. {{city_name}} <small>({{ratio}})</small></a></h5></li><li class='hide-on-small-only hide-on-large-only'><div class='valign'><a class='white-text hoverable' style='padding-left:5px; padding-right:5px; font-size:12pt;' href='/city.html?city_id={{city_id}}'>{{position}}. {{city_name}} <small>({{ratio}})</small></a></div></li>{{/results}}", { 'results': top_five });
            $('#meters_squared_per_person').html(renderedList);
          }, error: function(jqXHR, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
        $.ajax({
          type:'GET',
          url: 'http://localhost:8000/cidades/ranking/funcionario/percentual?format=json&nome_tipo=Comissionado',
          data: {},
          success: function(data, status) {
            var top_five = [];
            var index = 0;
            for (entry in data["folhas"]) {
              if (index >= 5) {
                break;
              }
              var city_id = data["folhas"][entry]["cidade"]["id"];
              var city_name = data["folhas"][entry]["cidade"]["nome"];
              var comissionados = data["folhas"][entry]["funcionarios"]['Comissionado']['quantidade'];
              var workers_total = count_workers(data["folhas"][entry]["funcionarios"]);
              top_five.push({ 'city_id': city_id, 'city_name': city_name, 'quantidade': comissionados, 'total' : workers_total, 'position': ++index  });
            }
            var renderedList = Mustache.render("<li><h5 class='valign white-text' style='min-height:100px;'>Mais funcionários comissionados<br/><small>(comissionados / total)</small></h5></li>{{#results}}<li class='hide-on-med-only'><h5 class='valign'><a class='white-text hoverable' style='padding-left:20px; padding-right:20px;' href='/city.html?city_id={{city_id}}'>{{position}}. {{city_name}} <small>({{quantidade}} / {{total}})</small></a></h5></li><li class='hide-on-small-only hide-on-large-only'><div class='valign'><a class='white-text hoverable' style='padding-left:5px; padding-right:5px; font-size:12pt;' href='/city.html?city_id={{city_id}}'>{{position}}. {{city_name}} <small>({{quantidade}} / {{total}})</small></a></div></li>{{/results}}", { 'results': top_five });
            $('#comissionados_por_total').html(renderedList);
          }, error: function(jqXHR, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
        $.ajax({
          type:'GET',
          url: 'http://localhost:8000/cidades/ranking/funcionario/populacao?format=json',
          data: {},
          success: function(data, status) {
            var top_five = [];
            var index = 0;
            for (entry in data["folhas"]) {
              if (index >= 5) {
                break;
              }
              var city_id = data["folhas"][entry]["cidade"]["id"];
              var city_name = data["folhas"][entry]["cidade"]["nome"];
              var populacao = data["folhas"][entry]["populacao"];
              var workers_total = count_workers(data["folhas"][entry]["funcionarios"]);
              top_five.push({ 'city_id': city_id, 'city_name': city_name, 'ratio': (1000 * workers_total / populacao).toFixed(2), 'total' : workers_total, 'position': ++index  });
            }
            var renderedList = Mustache.render("<li><h5 class='valign white-text' style='min-height:100px;'>Mais funcionários por habitante<br/><small>(funcionários por mil hab.)</small></h5></li>{{#results}}<li class='hide-on-med-only'><h5 class='valign'><a class='white-text hoverable' style='padding-left:20px; padding-right:20px;' href='/city.html?city_id={{city_id}}'>{{position}}. {{city_name}} <small>({{ratio}})</small></a></h5></li><li class='hide-on-small-only hide-on-large-only'><div class='valign'><a class='white-text hoverable' style='padding-left:5px; padding-right:5px; font-size:12pt;' href='/city.html?city_id={{city_id}}'>{{position}}. {{city_name}} <small>({{ratio}})</small></a></div></li>{{/results}}", { 'results': top_five });
            $('#cargos_por_habitante').html(renderedList);
          }, error: function(jqXHR, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
        $.ajax({
          type:'GET',
          url: 'http://localhost:8000/cidades?format=json',
          data: {},
          success: function(cities_data, status) {
            $('#city_search').on("change", function() {
              var city_query = $('#city_search').val();
              var cities_found = [];
              for (city_data in cities_data) {
                var city_name = cities_data[city_data]["nome"];
                var city_id = cities_data[city_data]["id"];
                if (city_name.toLowerCase().includes(city_query.toLowerCase())) {
                  cities_found.push({ 'city_name': city_name, 'city_id': city_id });
                }
              }
              if (cities_found.length <= 0) {
                $('.dropdown-button').dropdown('close');
              } else {
                var renderedList = Mustache.render("{{#cities}}<li><a href='/city.html?city_id={{city_id}}'>{{city_name}}</a></li>{{/cities}}", { 'cities': cities_found });
                $('#city_search_dropdown').html(renderedList);
                $('.dropdown-button').dropdown('open');
              }
            });
          }, error: function(jqXHR, textStatus, errorThrown) {
            console.log(errorThrown);
          }
        });
      });
    </script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-83609453-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html> -->
